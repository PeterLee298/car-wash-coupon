<view class="container">
  <!-- 月份选择 -->
  <view class="header">
    <view class="month-selector" bindtap="showMonthPicker">
      <text>{{currentMonth}}</text>
      <text class="arrow">▼</text>
    </view>
  </view>

  <!-- 记录列表 -->
  <view class="record-list">
    <view wx:for="{{records}}" wx:key="id" class="record-item" bindtap="navigateToDetail" data-id="{{item.id}}">
      <view class="record-header">
        <text class="coupon-code">{{item.couponCode}}</text>
        <text class="{{getStatusClass(item.status)}}">{{getStatusText(item.status)}}</text>
      </view>
      <view class="record-body">
        <view class="info-row">
          <text class="label">优惠券：</text>
          <text class="value">{{item.couponTypeName}}</text>
        </view>
        <view class="info-row">
          <text class="label">提交时间：</text>
          <text class="value">{{item.submitTime}}</text>
        </view>
        <view class="info-row">
          <text class="label">门店：</text>
          <text class="value">{{item.storeName}}</text>
        </view>
      </view>
      <view class="record-footer">
        <view wx:if="{{item.status === 'UPLOAD_NEEDED'}}">
          <button class="upload-btn" bindtap="uploadPhotos" data-record="{{item}}">上传照片</button>
        </view>
      </view>
    </view>

    <!-- 加载状态 -->
    <view wx:if="{{isLoading}}" class="loading">
      <text>加载中...</text>
    </view>

    <!-- 无数据 -->
    <view wx:if="{{!isLoading && records.length === 0}}" class="empty">
      <text>暂无核销记录</text>
    </view>

    <!-- 无更多数据 -->
    <view wx:if="{{!isLoading && !hasMore && records.length > 0}}" class="no-more">
      <text>没有更多记录了</text>
    </view>
  </view>

  <!-- 月份选择器 -->
  <view wx:if="{{showMonthPicker}}" class="month-picker-overlay" bindtap="hideMonthPicker">
    <view class="month-picker" catchtap="">
      <view class="picker-header">
        <text class="picker-title">选择月份</text>
        <text class="close-btn" bindtap="hideMonthPicker">×</text>
      </view>
      <view class="picker-body">
        <view wx:for="{{months}}" wx:key="index" class="month-item" bindtap="selectMonth" data-month="{{item}}">
          <text>{{item}}</text>
        </view>
      </view>
    </view>
  </view>
</view>